TEST_F(LstmFp32Test, Testcase02) {
  const int num_direction = 2;
  const int hidden_size = 4;
  const int seq_len = 1;
  const int batch_size = 2;
  const int input_size = 2;
  std::vector<float> input_x = {1.76405239, 0.400157213, 0.97873801, 2.24089313};
  std::vector<float> weight_i = {-0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 -0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0};
  std::vector<float> weight_h = {-0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 -0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0};
  std::vector<float> input_bias(num_direction * 8 * hidden_size, 0);
  std::vector<float> state_bias(num_direction * 8 * hidden_size, 0);
  std::vector<float> input_h = {1.867558,    -0.977277875, 0.950088441, -0.151357204, -0.103218853, 0.410598516,
                                0.144043565, 1.45427346,   0.761037707, 0.121675014,  0.443863243,  0.333674341,
                                1.49407911,  -0.205158263, 0.313067704, -0.854095757};
  std::vector<float> input_c = {-2.55298972,  0.653618574,  0.864436209,  -0.742165029, 2.26975465, -1.45436573,
                                0.0457585156, -0.187183857, 1.53277922,   1.4693588,    0.15494743, 0.378162533,
                                -0.887785733, -1.98079646,  -0.347912163, 0.156348974};
  // const int output_y_shape = seq_len * num_direction * batch_size * hidden_size;
  // const int output_h_shape = num_direction * batch_size * hidden_size;
  // const int output_c_shape = num_direction * batch_size * hidden_size;
  std::vector<float> output_y(seq_len * input_size * batch_size, 0.0);
  std::vector<std::vector<float>> buffer_storage;
  buffer_storage.reserve(4);
  for (int i = 0; i < 4; i++) {
    buffer_storage.emplace_back(192, 0.0f);
  }
  float *buffer[7] = {buffer_storage[0].data(),
                      buffer_storage[1].data(),
                      buffer_storage[2].data(),
                      buffer_storage[3].data(),
                      nullptr,
                      nullptr,
                      nullptr};
  const LstmParameter lstm_parameter = {{"", 87, 1, 0}, 2, 4, 0, 4, 1, 2, 16, true, 0, 0, 12, 8, 12, 8, 8, false};
  Lstm(output_y.data(), input_x.data(), weight_i.data(), weight_h.data(), input_bias.data(), state_bias.data(),
       input_h.data(), input_c.data(), buffer, &lstm_parameter);
  std::cout << "output_y :\n";
  std::for_each(output_y.begin(), output_y.end(), [](float value) { std::cout << value << " "; });
  std::cout << "output_h :\n";
  std::for_each(input_h.begin(), output_y.end(), [](float value) { std::cout << value << " "; });
  std::cout << "output_c :\n";
  std::for_each(input_c.begin(), output_y.end(), [](float value) { std::cout << value << " "; });
  ASSERT_GT(1.0, 0.99);
}