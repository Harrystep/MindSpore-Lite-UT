TEST_F(LstmFp32Test, Testcase02) {
  const int num_direction = 2;
  const int hidden_size = 4;
  const int seq_len = 1;
  const int batch_size = 2;
  std::vector<float> input_x = {1.76405239, 0.400157213, 0.97873801, 2.24089313};
  std::vector<float> weight_i = {-0.765201986, -1.12542903, 0.276854992, 0.404947013, 0, 0, 0, 0,
                                 0.395363003, 0.866087019, 0.435449988, -0.0894180015, 0, 0, 0, 0,
                                 0.536531985, -0.387838989, 0.910871983, -0.672026992, 0, 0, 0, 0,
                                 1.63611901, 0.355396986, 0.820452988, -2.96555209, 0, 0, 0, 0,
								 -0.807094991, -0.97923398, 1.62421405, -0.097231999, 0, 0, 0, 0,
                                 -1.30400896, 0.0599609986, -0.0025859999, -0.627036989, 0, 0, 0, 0,
                                 0.77807498, -0.59759599, -1.26198399, 0.312074989, 0, 0, 0, 0,
                                 -0.299656004, -0.932537019, 1.24318194, 1.17153299, 0, 0, 0, 0,
                                 0.520524979, 1.61944497, 0.231812999, 1.05095696, 0, 0, 0, 0,
                                 -1.63942802, -3.12055302, -0.259535015, -0.270639986, 0, 0, 0, 0,
                                 0.927289009, 1.27155304, 0.264918, 0.0244660005, 0, 0, 0, 0,
                                 -0.714639008, 0.453967988, 0.863536, 1.52308095, 0, 0, 0, 0,
                                 0.0579789989, -0.373863995, -0.847151995, -1.55265605, 0, 0, 0, 0,
                                 -0.607210994, 0.883210003, -0.768808007, 0.734449983, 0, 0, 0, 0,
                                 -0.745571017, -0.233737007, 0.196994007, -0.676805019, 0, 0, 0, 0,
                                 1.39568996, -0.289402008, -0.298283011, -0.276721001, 0, 0, 0, 0};
  std::vector<float> weight_h = {-0.0360120013, -0.111079, 0.169636995, 1.15874803, 0, 0, 0, 0,
                                 1.34984398, -0.986853004, 0.435732991, 0.724861026, 0, 0, 0, 0,
                                 -2.16698194, -1.08435595, 2.60577607, 0.452210993, 0, 0, 0, 0,
                                 -1.86817396, 0.708972991, 0.341585994, -0.165344, 0, 0, 0, 0,
                                 0.212634996, -0.659326971, -1.62445498, -1.17591596, 0, 0, 0, 0,
                                 1.55023098, -0.56200701, -0.301602989, 2.13495398, 0, 0, 0, 0,
                                 -0.679396987, -0.0067090001, -0.890645981, 0.195517004, 0, 0, 0, 0,
                                 -1.10215294, 0.864576995, 0.462532997, 0.304378003, 0, 0, 0, 0,
                                 -0.603076994, -1.17457294, -0.0935610011, 1.60665298, 0, 0, 0, 0,
                                 0.219426006, 0.294120014, -0.50266999, 1.85092199, 0, 0, 0, 0,
                                 0.0864640027, -1.64779902, 0.144926995, -0.184642002, 0, 0, 0, 0,
                                 0.167448997, -0.0613449998, 0.56507802, 0.627041996, 0, 0, 0, 0,
                                 -0.184533, -0.0507480018, -0.310018986, -1.668118, 0, 0, 0, 0,
                                 1.46780503, -0.191159993, 0.793407977, 1.09177005, 0, 0, 0, 0,
                                 -1.741045, 1.55262303, -0.84217602, -0.101896003, 0, 0, 0, 0,
                                 -0.833243012, 0.336293995, -0.077000998, 0.013479, 0, 0, 0, 0,
                                 -1.13307405, 0.0927530006, -1.60643899, -0.25317201, 0, 0, 0, 0,
                                 -1.38653398, 0.160782993, 0.540279984, -1.31765199, 0, 0, 0, 0,
                                 0.531876981, 0.406827986, -1.06837499, 1.42470002, 0, 0, 0, 0,
                                 -1.57716298, -0.511268973, -0.876331985, -0.909577012, 0, 0, 0, 0,
                                 0.978883028, 1.061113, 0.192048997, 1.26100397, 0, 0, 0, 0,
                                 1.06071603, -0.176679999, 0.635701001, -0.0255069993, 0, 0, 0, 0,
                                 1.15459299, 1.58312905, -0.221594006, 0.686751008, 0, 0, 0, 0,
                                 1.29433203, -0.809373975, -0.964457989, 0.822803974, 0, 0, 0, 0,
                                 1.59184003, 0.0791520029, 0.676380992, -0.171156004, 0, 0, 0, 0,
                                 1.15523601, -1.53236103, -0.302902013, -0.382088989, 0, 0, 0, 0,
                                 0.536866009, 0.777414024, -0.224638, -0.357856989, 0, 0, 0, 0,
                                 -1.38000202, 2.76831698, 0.0986040011, 1.07032895, 0, 0, 0, 0,
                                 0.636232972, 0.399049997, -0.252746999, -0.356658995, 0, 0, 0, 0,
                                 -1.48906195, 1.14711595, 0.246891007, 2.04904103, 0, 0, 0, 0,
                                 0.64487797, -0.557703972, -2.29016209, -0.176266, 0, 0, 0, 0,
                                 1.45664203, 0.107556, 1.86725998, -1.39619195, 0, 0, 0, 0};
  std::vector<float> input_bias(num_direction * 8 * hidden_size, 0);
  std::vector<float> state_bias(num_direction * 8 * hidden_size, 0);
  std::vector<float> input_h = {1.867558,    -0.977277875, 0.950088441, -0.151357204, -0.103218853, 0.410598516,
                                0.144043565, 1.45427346,   0.761037707, 0.121675014,  0.443863243,  0.333674341,
                                1.49407911,  -0.205158263, 0.313067704, -0.854095757};
  std::vector<float> input_c = {-2.55298972,  0.653618574,  0.864436209,  -0.742165029, 2.26975465, -1.45436573,
                                0.0457585156, -0.187183857, 1.53277922,   1.4693588,    0.15494743, 0.378162533,
                                -0.887785733, -1.98079646,  -0.347912163, 0.156348974};
  const int output_y_shape = seq_len * num_direction * batch_size * hidden_size;
  const int output_h_shape = num_direction * batch_size * hidden_size;
  const int output_c_shape = num_direction * batch_size * hidden_size;
  std::vector<float> output_y(output_y_shape, 0.0);
  std::vector<std::vector<float>> buffer_storage;
  buffer_storage.reserve(4);
  for (int i = 0; i < 4; i++) {
    buffer_storage.emplace_back(192, 0.0f);
  }
  float *buffer[7] = {buffer_storage[0].data(),
                      buffer_storage[1].data(),
                      buffer_storage[2].data(),
                      buffer_storage[3].data(),
                      nullptr,
                      nullptr,
                      nullptr};
  std::vector<float> benchmark_y = {
	-0.05464574694633484, 0.0025473765563219786, -0.01800093986093998, -0.0013057608157396317,
	0.02324358932673931, -0.6779391765594482, 0.6851275563240051, 0.0012448542984202504,
	0.799004077911377, 0.636780321598053, -0.013936851173639297, -0.5860180258750916,
	-0.28800132870674133, -0.7391406297683716, -0.1292552798986435, -0.5458848476409912,
  };
  std::vector<float> benchmark_h = {
	-0.05464574694633484, 0.0025473765563219786, -0.01800093986093998, -0.0013057608157396317,
	0.02324358932673931, -0.6779391765594482, 0.6851275563240051, 0.0012448542984202504,
	0.799004077911377, 0.636780321598053, -0.013936851173639297, -0.5860180258750916,
	-0.28800132870674133, -0.7391406297683716, -0.1292552798986435, -0.5458848476409912,
  };
  std::vector<float> benchmark_c = {
	-0.1094755008816719, 0.012485845945775509, -0.11909550428390503, -1.389187216758728,
	0.02428986132144928, -1.1805717945098877, 0.8870633244514465, 0.4559920132160187,
	1.1966338157653809, 0.7812789678573608, -0.021465852856636047, -0.7782428860664368,
	-0.7536125779151917, -0.958892822265625, -0.13587768375873566, -0.6186789274215698,
  };
  const LstmParameter lstm_parameter = {{"", 87, 1, 0}, 2, 4, 0, 4, 1, 2, 16, true, 0, 0, 12, 8, 12, 8, 8, false};
  Lstm(output_y.data(), input_x.data(), weight_i.data(), weight_h.data(), input_bias.data(), state_bias.data(),
       input_h.data(), input_c.data(), buffer, &lstm_parameter);
  std::cout << "output_y :\n";
  std::for_each(output_y.begin(), output_y.end(), [](float value) { std::cout << value << " "; });
  std::cout << "output_h :\n";
  std::for_each(input_h.begin(), input_h.end(), [](float value) { std::cout << value << " "; });
  std::cout << "output_c :\n";
  std::for_each(input_c.begin(), input_c.end(), [](float value) { std::cout << value << " "; });
  float sim_y = get_cosine_similarity(output_y.data(), benchmark_y.data(), output_y_shape);
  float sim_h = get_cosine_similarity(input_h.data(), benchmark_h.data(), output_h_shape);
  float sim_c = get_cosine_similarity(input_c.data(), benchmark_c.data(), output_c_shape);
  ASSERT_GT(sim_y, 0.99);
  ASSERT_GT(sim_h, 0.99);
  ASSERT_GT(sim_c, 0.99);
}

